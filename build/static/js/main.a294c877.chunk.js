(this["webpackJsonpinstagram-clone"]=this["webpackJsonpinstagram-clone"]||[]).push([[0],{59:function(e,a,t){e.exports=t(86)},64:function(e,a,t){},65:function(e,a,t){},66:function(e,a,t){},78:function(e,a,t){},84:function(e,a,t){},85:function(e,a,t){},86:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),l=t(11),o=t.n(l),r=(t(64),t(5)),s=(t(65),t(66),t(116)),i=t(18),m=t.n(i),u=m.a.initializeApp({apiKey:"AIzaSyCZ7SX_2NwAxflElWcWaOe7QuqBk2oXRvk",authDomain:"cap-this.firebaseapp.com",databaseURL:"https://cap-this-default-rtdb.firebaseio.com",projectId:"cap-this",storageBucket:"cap-this.appspot.com",messagingSenderId:"357983648624",appId:"1:357983648624:web:fa4a414168ee3a9317edb5",measurementId:"G-2C4QFNL1B1"}).firestore(),p=m.a.auth(),d=m.a.storage(),f=t(41),g=t.n(f),E=t(50),v=t.n(E),b=t(51),h=t.n(b),_=t(52),N=t.n(_),j=t(53),O=t.n(j),y=t(108);t(78);var S=function(e){var a=e.commentId,t=e.postId,n=e.curUser,l=e.username,o=e.text;return c.a.createElement("div",{className:"comment",key:"comment.id"},c.a.createElement("div",null,c.a.createElement("b",null,l)," ",o),n&&(null===n||void 0===n?void 0:n.displayName)===l?c.a.createElement(y.a,{color:"primary","aria-label":"upload picture",component:"span",className:"delete-comment"},c.a.createElement(g.a,{className:"delete-icon",onClick:function(){u.collection("posts").doc(t).collection("comments").doc(a).delete().then(console.log(a))}})):c.a.createElement(c.a.Fragment,null))},w=Object(n.forwardRef)((function(e,a){var t=e.user,l=e.username,o=e.postId,i=e.imageUrl,m=e.caption,p=e.curUser,d=Object(n.useState)([]),f=Object(r.a)(d,2),E=f[0],b=f[1],_=Object(n.useState)(""),j=Object(r.a)(_,2),w=j[0],C=j[1],k=Object(n.useState)("/static/images/avatar/1.jpg"),x=Object(r.a)(k,2),U=x[0],I=x[1];Object(n.useEffect)((function(){u.collection("avatars").doc(l).collection("avatarUrls").orderBy("timestamp","desc").onSnapshot((function(e){e.empty?console.log("No avatar"):I(e.docs[0].data().avatarUrl)}))}),[]),Object(n.useEffect)((function(){var e;return o&&(e=u.collection("posts").doc(o).collection("comments").onSnapshot((function(e){b(e.docs.map((function(e){return{id:e.id,comment:e.data()}})))}))),function(){e()}}),[o]);return c.a.createElement("div",{className:"post",ref:a},c.a.createElement("div",{className:"post__header"},c.a.createElement("div",{className:"post__meta"},c.a.createElement(s.a,{className:"post__avatar",alt:l,src:U}),c.a.createElement("h3",null,l)),c.a.createElement("div",{className:"post__option"},p&&(null===p||void 0===p?void 0:p.displayName)===l?c.a.createElement(y.a,{color:"primary","aria-label":"upload picture",component:"span",className:"post__delete",onClick:function(){u.collection("posts").doc(o).delete()}},c.a.createElement(g.a,{style:{fontSize:20},className:"delete-icon"})):c.a.createElement(c.a.Fragment,null))),i?""===i.trim()?c.a.createElement(c.a.Fragment,null):c.a.createElement("img",{className:"post__image",src:i,alt:"post"}):c.a.createElement(c.a.Fragment,null),m?c.a.createElement("h4",{className:"post__text"},l," ",c.a.createElement("span",{className:"post__caption"},m)):c.a.createElement(c.a.Fragment,null),c.a.createElement("div",{className:"post__button__row"},c.a.createElement("div",{className:"post__button__row__left"},c.a.createElement(y.a,null,c.a.createElement(v.a,null)),c.a.createElement(y.a,null,c.a.createElement(h.a,null)),c.a.createElement(y.a,null,c.a.createElement(N.a,null))),c.a.createElement("div",{className:"post__button__row__left"},c.a.createElement(y.a,null,c.a.createElement(O.a,null)))),c.a.createElement("div",{className:"post__comments"},E.map((function(e){var a=e.id,t=e.comment;return console.log(a),console.log(t.username),c.a.createElement(S,{key:a,commentId:a,postId:o,curUser:p,username:t.username,text:t.text})}))),t&&c.a.createElement("form",{className:"post__commentBox"},c.a.createElement("input",{className:"post__input",type:"text",placeholder:"Add a comment...",value:w,onChange:function(e){return C(e.target.value)}}),c.a.createElement("button",{disabled:!w,className:"post__button",type:"submit",onClick:function(e){e.preventDefault(),u.collection("posts").doc(o).collection("comments").add({text:w,username:t.displayName}),C("")}},"Post")))})),C=(t(84),t(114)),k=t(111),x=t(115),U=function(e){var a=e.username,t=Object(n.useState)(null),l=Object(r.a)(t,2),o=l[0],s=l[1],i=Object(n.useState)(""),p=Object(r.a)(i,2),f=(p[0],p[1]),g=Object(n.useState)(0),E=Object(r.a)(g,2),v=E[0],b=E[1],h=Object(n.useState)(""),_=Object(r.a)(h,2),N=_[0],j=_[1];return c.a.createElement("div",{className:"imageupload"},c.a.createElement("progress",{className:"imageupload__progress",value:v,max:"100"}),c.a.createElement(C.a,{placeholder:"Enter a caption",value:N,onChange:function(e){return j(e.target.value)}}),c.a.createElement("div",null,c.a.createElement("input",{type:"file",onChange:function(e){e.target.files[0]&&s(e.target.files[0])}}),c.a.createElement(k.a,{className:"imageupload__button",onClick:function(){if(o){var e=Object(x.a)().concat("-",o.name);d.ref("images/".concat(e)).put(o).on("state_changed",(function(e){var a=Math.round(e.bytesTransferred/e.totalBytes*100);b(a)}),(function(e){console.log(e)}),(function(){d.ref("images").child(e).getDownloadURL().then((function(e){f(e),u.collection("posts").add({imageUrl:e,caption:N,username:a,timestamp:m.a.firestore.FieldValue.serverTimestamp()}),b(0),j(""),s(null)}))}))}else""!==N.trim()&&(u.collection("posts").add({caption:N,username:a,timestamp:m.a.firestore.FieldValue.serverTimestamp()}),j(""))}},"Upload")),c.a.createElement("br",null))},I=t(112),L=t(113),B=t(54);t(85);var A=function(e){var a=e.user,t=Object(n.useState)((function(){return{height:"300px",top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}})),l=Object(r.a)(t,1)[0],o=Object(n.useState)(!1),i=Object(r.a)(o,2),p=i[0],f=i[1],g=Object(I.a)((function(e){return{paper:{position:"absolute",width:400,height:200,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}))(),E=Object(n.useState)(null),v=Object(r.a)(E,2),b=v[0],h=v[1],_=Object(n.useState)("/static/images/avatar/1.jpg"),N=Object(r.a)(_,2),j=N[0],O=N[1],S=Object(n.useState)(0),w=Object(r.a)(S,2),C=w[0],x=w[1];return u.collection("avatars").doc(a.displayName).collection("avatarUrls").orderBy("timestamp","desc").limit(1).get().then((function(e){e.empty?console.log("No avatar"):e.docs.map((function(e){O(e.data().avatarUrl)}))})),c.a.createElement("div",null,c.a.createElement(y.a,{onClick:function(){f(!0)}},c.a.createElement(s.a,{className:"app__headerAvatar",alt:a.displayName,src:j})),c.a.createElement(L.a,{open:p,onClose:function(){return f(!1)}},c.a.createElement("div",{style:l,className:g.paper},c.a.createElement("form",{className:"app__setAvatar"},c.a.createElement("div",{className:"avatar"},c.a.createElement("progress",{className:"avatarupload__progress",value:C,max:"100"}),c.a.createElement("div",null,c.a.createElement("input",{type:"file",onChange:function(e){e.target.files[0]&&h(e.target.files[0])}}),c.a.createElement(k.a,{className:"avatarupload__button",onClick:function(){b&&d.ref("avatars/".concat(b.name)).put(b).on("state_changed",(function(e){var a=Math.round(e.bytesTransferred/e.totalBytes*100);x(a)}),(function(e){console.log(e)}),(function(){d.ref("avatars").child(b.name).getDownloadURL().then((function(e){O(e),console.log(e),u.collection("avatars").doc(a.displayName).collection("avatarUrls").add({avatarUrl:e,timestamp:m.a.firestore.FieldValue.serverTimestamp()}),x(0),h(null),f(!1)}))}))}},"Set a profile image...")))))))};function F(){return{height:"300px",top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var T=Object(I.a)((function(e){return{paper:{position:"absolute",width:400,height:200,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));var R=function(){var e=T(),a=Object(n.useState)(F),t=Object(r.a)(a,1)[0],l=Object(n.useState)([]),o=Object(r.a)(l,2),s=o[0],i=o[1],m=Object(n.useState)(""),d=Object(r.a)(m,2),f=d[0],g=d[1],E=Object(n.useState)(""),v=Object(r.a)(E,2),b=v[0],h=v[1],_=Object(n.useState)(""),N=Object(r.a)(_,2),j=N[0],O=N[1],y=Object(n.useState)(null),S=Object(r.a)(y,2),x=S[0],I=S[1],R=Object(n.useState)(!1),D=Object(r.a)(R,2),W=D[0],P=D[1],z=Object(n.useState)(!1),M=Object(r.a)(z,2),V=(M[0],M[1],Object(n.useState)(!1)),J=Object(r.a)(V,2),Q=J[0],X=J[1];return Object(n.useEffect)((function(){var e=p.onAuthStateChanged((function(e){I(e||null)}));return function(){e()}}),[x,f]),Object(n.useEffect)((function(){u.collection("posts").orderBy("timestamp","desc").onSnapshot((function(e){i(e.docs.map((function(e){return{id:e.id,post:e.data()}})))}))}),[]),c.a.createElement("div",{className:"app"},c.a.createElement(L.a,{open:W,onClose:function(){return P(!1)}},c.a.createElement("div",{style:t,className:e.paper},c.a.createElement("form",{className:"app__login"},c.a.createElement("center",null,c.a.createElement("img",{className:"app__headerImage",src:"capThisLogo.png",alt:""})),c.a.createElement(C.a,{placeholder:"email",type:"text",value:b,onChange:function(e){return h(e.target.value)}}),c.a.createElement(C.a,{placeholder:"password",type:"password",value:j,onChange:function(e){return O(e.target.value)}}),c.a.createElement(k.a,{onClick:function(e){e.preventDefault(),p.signInWithEmailAndPassword(b,j).catch((function(e){return alert(e.message)})),P(!1)}},"Login")))),c.a.createElement(L.a,{open:Q,onClose:function(){return X(!1)}},c.a.createElement("div",{style:t,className:e.paper},c.a.createElement("form",{className:"app__login"},c.a.createElement("center",null,c.a.createElement("img",{className:"app__headerImage",src:"capThisLogo.png",alt:""})),c.a.createElement(C.a,{type:"text",placeholder:"username",value:f,onChange:function(e){return g(e.target.value)}}),c.a.createElement(C.a,{placeholder:"email",type:"text",value:b,onChange:function(e){return h(e.target.value)}}),c.a.createElement(C.a,{placeholder:"password",type:"password",value:j,onChange:function(e){return O(e.target.value)}}),c.a.createElement(k.a,{onClick:function(e){e.preventDefault(),p.createUserWithEmailAndPassword(b,j).then((function(e){return e.user.updateProfile({displayName:f})})).catch((function(e){return alert(e.message)})),X(!1)}},"Register")))),c.a.createElement("div",{className:"app__header"},c.a.createElement("img",{className:"app__headerImage",src:"capThisLogo.png",alt:""}),(null===x||void 0===x?void 0:x.displayName)?c.a.createElement("div",{className:"app__headerRight"},c.a.createElement(k.a,{onClick:function(){return p.signOut()}},"Logout"),c.a.createElement(A,{user:x})):c.a.createElement("form",{className:"app__loginHome"},c.a.createElement(k.a,{onClick:function(){return P(!0)}},"Login"),c.a.createElement(k.a,{onClick:function(){return X(!0)}},"Sign Up"))),c.a.createElement("div",{className:"app__posts"},c.a.createElement("div",{className:"app__postsLeft"},c.a.createElement(B.a,null,s.map((function(e){var a=e.id,t=e.post;return c.a.createElement(w,{user:x,key:a,postId:a,username:t.username,caption:t.caption,imageUrl:t.imageUrl,curUser:x})}))))),(null===x||void 0===x?void 0:x.displayName)?c.a.createElement("div",{className:"app__upload"},c.a.createElement(U,{username:x.displayName})):c.a.createElement("center",null,c.a.createElement("h3",null,"Login to upload")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[59,1,2]]]);
//# sourceMappingURL=main.a294c877.chunk.js.map